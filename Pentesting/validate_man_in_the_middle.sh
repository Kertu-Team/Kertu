#!/bin/bash

# Cel testu
TARGET="https://kertu.org"

# Funkcja instalacji testssl.sh
install_testssl() {
  echo "testssl.sh not found. Installing..."
  git clone https://github.com/drwetter/testssl.sh.git /opt/testssl.sh
  ln -s /opt/testssl.sh/testssl.sh /usr/local/bin/testssl.sh
  echo "testssl.sh has been installed."
}

# Funkcja instalacji hexdump
install_hexdump() {
  echo "hexdump not found. Installing..."
  apt-get update
  apt-get install -y bsdmainutils
  echo "hexdump has been installed."
}

# Sprawdzenie, czy testssl.sh jest zainstalowane
if ! command -v testssl.sh &> /dev/null; then
  install_testssl
fi

# Sprawdzenie, czy hexdump jest zainstalowane
if ! command -v hexdump &> /dev/null; then
  install_hexdump
fi

# Wykonanie testu MITM
echo "Testing for Man-in-the-Middle vulnerabilities..."
testssl.sh $TARGET
echo "MITM vulnerability test completed."