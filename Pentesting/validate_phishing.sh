#!/bin/bash

TARGET="https://kertu.org"
REDIRECT_PATH="/redirect.php?url=https://youtube.com"

echo "Testing for Open Redirect vulnerability..."

# Wykonanie żądania CURL
RESULT=$(curl -si -o /dev/null -w "%{http_code}" "$TARGET$REDIRECT_PATH")

# Analiza wyniku
if [[ "$RESULT" == "302" ]]; then
  echo "Potential Open Redirect detected! The server responded with a 302 status code."
  echo "The redirect location is handled by Cloudflare Access, which may mitigate some risks."
else
  echo "No direct Open Redirect detected. Server responded with HTTP code: $RESULT"
fi

echo "Phishing vulnerability test completed."