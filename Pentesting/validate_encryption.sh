#!/bin/bash

TARGET="https://kertu.org"

echo "Validating SSL/TLS encryption for $TARGET..."

# Sprawdzenie dostępności celu
if ! ping -c 1 -W 1 $(echo $TARGET | awk -F[/:] '{print $4}') > /dev/null 2>&1; then
    echo "Target $TARGET is not reachable. Exiting..."
    exit 1
fi

# Uruchomienie podstawowego skanowania SSL/TLS
echo "Performing basic SSL/TLS scan..."
sslscan $TARGET

# Testowanie podatności na SSL/TLS
echo "Testing for vulnerabilities (e.g., Heartbleed, POODLE)..."
nmap --script ssl-enum-ciphers -p 443 $(echo $TARGET | awk -F[/:] '{print $4}')

# Analiza certyfikatu SSL/TLS
echo "Fetching certificate details..."
openssl s_client -connect $(echo $TARGET | awk -F[/:] '{print $4}'):443 -showcerts < /dev/null | openssl x509 -noout -text | grep -E "Issuer|Subject|Not After|Not Before"

# Sprawdzenie obsługi protokołów
echo "Testing supported protocols..."
nmap --script ssl-protocols -p 443 $(echo $TARGET | awk -F[/:] '{print $4}')

# Sprawdzenie konfiguracji HSTS (HTTP Strict Transport Security)
echo "Checking for HSTS configuration..."
curl -s -I $TARGET | grep -i "strict-transport-security"

echo "SSL/TLS validation completed."