#!/bin/bash

TARGET="kertu.org"

echo "Testing SSH configuration for $TARGET..."

# Menu wyboru testu
echo "Choose an option for SSH validation:"
echo "1) Basic Scan (Algorithms and Host Key)"
echo "2) Detailed Scan (Algorithms, Host Key, Weakness Detection, Brute Force Simulation)"
read -p "Enter your choice (1 or 2): " CHOICE

case $CHOICE in
    1)
        echo "Performing basic SSH scan..."
        nmap -p 22 --script ssh2-enum-algos,ssh-hostkey $TARGET
        ;;
    2)
        echo "Performing detailed SSH scan..."
        # Wyświetlenie algorytmów, kluczy i potencjalnych słabych punktów
        nmap -p 22 --script ssh2-enum-algos,ssh-hostkey,ssh-auth-methods,ssh-brute $TARGET
        ;;
    *)
        echo "Invalid choice. Exiting."
        exit 1
        ;;
esac

echo "SSH validation completed."