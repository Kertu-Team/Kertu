@page "/search"

@using Kertu.InteractiveServer.Data.Models.Elements

<RadzenCard Style="width: 600px; position: relative; --rz-card-padding: 0;">
	<RadzenRow>
		<!-- Pasek wyszukiwania z ikoną "X" -->
		<RadzenColumn Size="12">
			<div style="display: flex; align-items: center;">
				<!-- Pole wyszukiwania -->
				<RadzenTextBox Value="@SearchQuery"
							   Placeholder="Search..."
							   Style="width: 100%; font-size: 14px; color: #333;"
							   Change="@HandleSearchInput"
							   @onfocus="ShowResults"
							   AutoComplete="false"
							   Icon="search" />

				<!-- Ikona zamykania "X" -->
				<RadzenButton Icon="close"
							Style="cursor: pointer; font-size: 20px; background-color: red; color: #333;"
							Click="ClearSearch" />
			</div>
		</RadzenColumn>
	</RadzenRow>

	<!-- Dropdown z wynikami wyszukiwania -->
	@if (ShowDropdown)
	{
		<RadzenPanel Style="position: absolute; top: 100%; left: 0; width: 100%; color: #333; max-height: 300px; overflow-y: auto; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); border-radius: 4px;">
			<!-- Opcje zakresu wyszukiwania -->
			<RadzenRow Style="padding: 8px;">
				<RadzenColumn Size="6">
					<RadzenButton Text="Search Everywhere"
								  Click="() => SetScope(SearchScope.Global)"
								  Class="@(CurrentScope == SearchScope.Global ? "active-option" : "")"
								  Style="width: 100%; border: none; background: none; cursor: pointer; font-size: 14px; padding: 8px; border-radius: 4px; color: #333;" />
				</RadzenColumn>
				<RadzenColumn Size="6">
					<RadzenButton Text="Search in Current"
								  Click="() => SetScope(SearchScope.Children)"
								  Class="@(CurrentScope == SearchScope.Children ? "active-option" : "")"
								  Style="width: 100%; border: none; background: none; cursor: pointer; font-size: 14px; padding: 8px; border-radius: 4px; color: #333;" />
				</RadzenColumn>
			</RadzenRow>

			<!-- Lista wyników wyszukiwania -->
			@if (SearchResults?.Any() == true)
			{
				<RadzenDataList Data="@SearchResults" Style="padding: 0;">
					<Template Context="result">
						<div @onclick="() => NavigateToElement(result)" style="cursor: pointer; transition: background-color 0.3s; color: #333;">
							<RadzenLabel Text="@result.Name" />
						</div>
					</Template>
				</RadzenDataList>
			}
			else if (!string.IsNullOrWhiteSpace(SearchQuery))
			{
				<div style="color: #888; font-style: italic;">
					No results found.
				</div>
			}
		</RadzenPanel>
	}
</RadzenCard>

<style>
	.active-option {
		font-weight: bold;
	}
</style>